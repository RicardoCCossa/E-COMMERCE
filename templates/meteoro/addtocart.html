{% extends 'partials/base.html' %}
{% load static %}

{% block title %}Carrinho{% endblock title %}

{% block content %}
<div class="container my-5">
    <div class="row">
        {% if cart_items %}
            <h1 class="text-center mb-5">ðŸ›’ Carrinho de Compras</h1>

            <!-- Lista de produtos -->
            <div class="col-sm-8">
                <div class="card shadow-sm border-0 rounded-3">
                    <div class="card-body">
                        {% for item in cart_items %}
                            <div class="row mb-3 align-items-center">
                                <div class="col-sm-3 text-center">
                                    <img src="{{ item.product.product_image.url }}" 
                                         alt="{{ item.product.title }}" 
                                         class="img-fluid img-thumbnail shadow-sm rounded" 
                                         height="150" width="150">
                                </div>

                                <div class="col-sm-9">
                                    <h5 class="fw-bold">{{ item.product.title }}</h5>
                                    <p class="text-muted small">{{ item.product.description|truncatewords:15 }}</p>

                                    <div class="my-2">
                                        <label class="me-2">Quantidade:</label>
                                        <a href="#" class="minus-cart btn btn-outline-secondary btn-sm" pid="{{item.product.id}}">
                                            <i class="fas fa-minus"></i>
                                        </a>
                                        <span class="mx-2 fw-bold" id="quantity">{{ item.quantity }}</span>
                                        <a href="#" class="plus-cart btn btn-outline-secondary btn-sm" pid="{{item.product.id}}">
                                            <i class="fas fa-plus"></i>
                                        </a>
                                    </div>

                                    <div class="d-flex justify-content-between mt-2">
                                        <a href="#" class="remove-cart btn btn-danger btn-sm" pid="{{item.product.id}}">
                                            <i class="fas fa-trash"></i> Remover
                                        </a>
                                        <p class="fw-bold mb-0 text-success">{{ item.product.discounted_price }} MT</p>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Resumo do pedido -->
            <div class="col-sm-4">
                <div class="card shadow-sm border-0 rounded-3">
                    <div class="card-body">
                        <h4 class="fw-bold mb-3">Resumo da Compra</h4>
                        <ul class="list-group mb-3">
                            <li class="list-group-item d-flex justify-content-between">
                                <span>Transporte</span>
                                <span>40.00 MT</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total</strong>
                                <strong id="totalamount">{{ totalamount|add:40 }} MT</strong>
                            </li>
                        </ul>
                        <a href="{% url 'checkout' %}" class="btn btn-primary w-100">
                            <i class="fas fa-credit-card"></i> Finalizar Compra
                        </a>
                    </div>
                </div>
            </div>

        {% else %}
            <h1 class="text-center text-muted">ðŸ›’ O carrinho estÃ¡ vazio</h1>
        {% endif %}
    </div>
</div>
{% endblock content %}
